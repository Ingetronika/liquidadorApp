<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Easy Plant</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <style>
        /* Agrega estilo directamente para valores numéricos en negrita */
        .bold {
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Easy Plant</h1>
        <form id="calculation-form">
            <label for="numero">Número del tanque (8 o 9):</label>
            <input type="number" id="numero" name="numero" required>

            <label for="altura_inicial">Altura inicial (mm):</label>
            <input type="number" id="altura_inicial" name="altura_inicial" step="any" required>

            <label for="volumen_recibido">Volumen bruto recibido (galones):</label>
            <input type="number" id="volumen_recibido" name="volumen_recibido" step="any" required>

            <label for="api_observado">API:</label>
            <input type="number" id="api_observado" name="api_observado" step="any" required>

            <label for="temperatura">Temperatura (°F):</label>
            <input type="number" id="temperatura" name="temperatura" step="0.1" required>

            <button type="submit">Calcular</button>
        </form>
        <div id="results"></div>
    </div>

    <script>
        document.getElementById('calculation-form').addEventListener('submit', function(event) {
            event.preventDefault();

            const formData = new FormData(this);
            const data = Object.fromEntries(formData.entries());

            fetch('/calculate', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            })
            .then(response => response.json())
            .then(result => {
                if (result.error) {
                    document.getElementById('results').innerHTML = `<p class="bold">Error: ${result.error}</p>`;
                } else {
                    // Asegúrate de que los valores existen y son números antes de usar toFixed()
                    const volumenBrutoRecibido = Number(result.volumen_br_rec);
                    const volumenNetoRecibido = Number(result.vol_neto_rec);

                    document.getElementById('results').innerHTML = `
                        <p><strong>Altura Inicial:</strong> <span class="bold">${result.altura_inicial} mm</span></p>
                        <p><strong>Volumen Inicial:</strong> <span class="bold">${result.volumen_inicial} galones</span></p>
                        <p><strong>Altura Final:</strong> <span class="bold">${result.altura_final} mm</span></p>
                        <p><strong>Volumen Final:</strong> <span class="bold">${result.volumen_final} galones</span></p>
                        <p><strong>Volumen Bruto Recibido:</strong> <span class="bold">${!isNaN(volumenBrutoRecibido) ? volumenBrutoRecibido.toFixed(2) : 'N/A'} galones</span></p>
                        <p><strong>Temperatura:</strong> <span class="bold">${result.temperatura} °F</span></p>
                        <p><strong>API Observado:</strong> <span class="bold">${result.api_observado}</span></p>
                        <p><strong>API Corregido:</strong> <span class="bold">${result.api_corregido}</span></p>
                        <p><strong>Factor de Corrección:</strong> <span class="bold">${result.fac_cor}</span></p>
                        <p><strong>Volumen Neto Recibido:</strong> <span class="bold">${!isNaN(volumenNetoRecibido) ? volumenNetoRecibido.toFixed(2) : 'N/A'} galones</span></p>
                    `;
                }
            })
            .catch(error => {
                document.getElementById('results').innerHTML = `<p class="bold">Error: ${error.message}</p>`;
            });
        });
    </script>
</body>
</html>
